<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="theme-color" content="#000000"><meta name="twitter:card" content="summary"><meta property="og:url" content="https://www.viam-tech.com/#/"><meta property="og:image" content="https://www.viam-tech.com/images/logo/logo-fbog.png"><meta property="og:type" content="website"><link rel="manifest" href="/manifest.json"><link rel="shortcut icon" href="/favicon.ico"><meta name="google-site-verification" content="MZ97F6S1qqr7oLvw0nRIGyrsBz4aEQgrbXNtt6OZuYM"><link href="/static/css/2.0252c3bb.chunk.css" rel="stylesheet"><link href="/static/css/main.72609b3f.chunk.css" rel="stylesheet"><title>Hacking Explained: DNS Spoofing | Viam Technologies</title><meta property="og:title" content="Hacking Explained: DNS Spoofing | Viam Technologies" data-react-helmet="true"><meta name="description" content="What is DNS and DNS Spoofing? Security Engineer and Co-Founder Michael Wetherald gives a basic explanation of DNS and how it can be spoofed in order to..." data-react-helmet="true"><meta name="og:description" content="What is DNS and DNS Spoofing? Security Engineer and Co-Founder Michael Wetherald gives a basic explanation of DNS and how it can be spoofed in order to..." data-react-helmet="true"><script async="true" src="https://platform.twitter.com/widgets.js" charset="utf-8" data-react-helmet="true"></script></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="App" data-reactroot=""><a style="display:none" href="/form/onboarding"></a><a style="display:none" href="/form/operational-questionnaire"></a><a style="display:none" href="/form/technical-questionnaire"></a><div><div style="min-height:100vh;position:relative"><div><div style="background-color:black;padding:5px" class="ui large pointing secondary menu"><a href="/"><img src="/images/logo/logo-header-desktop.png" alt="logo" class="ui image header-menu-logo-desktop"></a><div class="ui container"><a class="item" href="/">Home</a><a class="item" href="/services">Services</a><a class="active item" href="/blog">Blog</a><a class="item" href="/contact">Contact</a></div></div></div><div style="min-height:1000px"><div id="blog-entry" class="ui vertical segment"><div class="ui container"><h1 style="margin-bottom:40px" class="ui header">Hacking Explained: DNS Spoofing<div class="sub header"><i aria-hidden="true" class="calendar alternate outline icon"></i>December 2018<!-- --> | <i aria-hidden="true" class="user outline icon"></i>Michael Wetherald</div></h1><div style="font-size:1.2rem"><div><p>The <b>Domain Name System (DNS)</b> is generally used to map domain names and IP addresses. For example, let’s consider the following network configuration:</p><img src="/images/blog/dns-spoof/config.jpg" alt="example network configuration with two clients 'alice' and 'bob' connected to an access point which acts as a gateway to the internet" class="ui centered image article-img"><p>If Alice wants to request the content of https://www.google.com in her web browser, the request needs to be sent to an IP address corresponding to one of Google’s web servers. If Alice hasn’t previously saved (cached) an IP address for Google.com’s web server, she will need to make a DNS query for the IP address assigned to Google.com. Which DNS server to use can be set manually on the client, but for our example let’s assume Alice hasn’t configured any. Most clients will use the DNS server as advertised by the Access Point that assigned them an IP address.</p><p>Often times the Access Point will also act as a DNS server and cache IP addresses for the domains it has previously queried. If the Access Point doesn’t have a cached record of the IP address for Alice’s DNS query, then it will need to forward the DNS query to the DNS server it is configured to use. Unless otherwise specified manually on the Access Point it may use an upstream DNS as advertised perhaps by the ISP. This chain (pictured below) continues all the way up to what is commonly referred to as a Root Name Server.</p><img src="/images/blog/dns-spoof/dns-chain.jpg" alt="sample dns server chain from alice -> access point -> isp dns -> root name server -> top level domain for com -> google's dns" class="ui centered image article-img"><p>A Root Name Server will direct the DNS query to the top level name server corresponding to the DNS request. For example in the domain name www.google.com, the top level domain is “com”. This top level name server knows which DNS servers to query for all domains registered as a “.com”. Assuming the domain name being queried by Alice’s DNS request is registered, it will eventually lead back down to one of Google’s DNS servers. If Google’s DNS server recognizes the domain being queried by Alice, it will respond with the IP address of a web server that her web browser can then use to fetch the contents of https://www.google.com.</p><p>DNS queries and replies currently do not use any sort of authentication or validation which opens up the opportunity for an attacker to spoof DNS replies. For example, let’s assume Alice is acting as a man-in-the-middle between Bob and the Access Point (for an example of this see my article on <a href="/blog/hacking-explained-arp-spoofing">ARP Spoofing</a>). Assuming Bob hasn’t manually set his DNS servers, he will automatically use Alice for DNS queries, allowing Alice to spoof the DNS replies with fake IP addresses and redirecting Bob to web servers of her choice.</p><p>Here’s a demonstration of how DNS Spoofing, <a href="/blog/hacking-explained-arp-spoofing">ARP Spoofing</a> and my <a href="/blog/hacking-explained-url-spoofing-trick">URL Spoofing Trick for Chrome</a> can be used to generate a pretty convincing victim scenario with my universal man-in-the-middle tool <a href="https://github.com/compewter/copycat" target="_blank">CopyCat</a>. CopyCat is a proof of concept tool for attackers like Alice to circumvent the security provided by HTTPS and see/modify the traffic, and allow victims like Bob to continue to use the services provided by HTTPS web servers:</p><img class="article-img" src="/images/blog/url-spoof/copycat-demo.gif" alt="GIF demonstration of someone navigating through several different pages using this spoofed url trick"></div></div><div class="ui vertical segment"><div class="ui container"><div class="ui divider"></div><div style="text-align:left" class="ui grid"><div class="two wide computer eight wide mobile column"><img src="/images/blog/michael.jpg" class="ui image"></div><div class="twelve wide computer sixteen wide mobile column"><div class="ui header">Michael Wetherald<div class="sub header">Security Engineer and Co-Founder</div></div><p>Michael is the inventor of a patent pending web proxy technology and brings to Viam his expertise in web and Linux security. Outside of work he enjoys carpentry, having built a dog mansion for his spoiled dog.</p><p>When criminals compromise your organization will you know? Viam Technologies provides a range of cyber security services.<br><a href="/contact">Contact us</a> today to be prepared.</p></div></div></div></div></div></div></div><div style="padding:5em 0em;background-color:black;bottom:0;width:100%" class="ui inverted vertical left aligned segment"><div class="ui container"><div class="ui inverted stackable divided grid"><div class="row"><div class="six wide column"><img style="margin:0 auto" height="50" src="/images/logo/logo-side-text.png" class="ui image"><p style="text-align:center;margin-top:20px">© <!-- -->2023<!-- --> Viam Technologies</p></div><div class="seven wide column"><h4 class="ui inverted header">Viam Technologies</h4><div role="list" class="ui inverted link list"><a role="listitem" class="item" href="mailto:contact@viam-tech.com">contact@viam-tech.com</a><a role="listitem" class="item" href="tel:1-858-295-8426">(858) 295-8426</a></div></div></div></div></div></div></div></div></div></div><script>!function(e){function t(t){for(var n,i,l=t[0],a=t[1],f=t[2],c=0,s=[];c<l.length;c++)i=l[c],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&s.push(o[i][0]),o[i]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);for(p&&p(t);s.length;)s.shift()();return u.push.apply(u,f||[]),r()}function r(){for(var e,t=0;t<u.length;t++){for(var r=u[t],n=!0,l=1;l<r.length;l++){var a=r[l];0!==o[a]&&(n=!1)}n&&(u.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},o={1:0},u=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var l=this["webpackJsonpviam-site"]=this["webpackJsonpviam-site"]||[],a=l.push.bind(l);l.push=t,l=l.slice();for(var f=0;f<l.length;f++)t(l[f]);var p=a;r()}([])</script><script src="/static/js/2.b4e3b2b6.chunk.js"></script><script src="/static/js/main.fa2d8498.chunk.js"></script></body></html>